<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>flask创建自定义网站导航</title>
    <url>/2023/03/09/flask%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BD%91%E7%AB%99%E5%AF%BC%E8%88%AA/</url>
    <content><![CDATA[<p>Flask: Flask是Python的一个轻量级Web应用程序框架。它允许开发人员使用Python编写Web应用程序，并在一个简单的、易于理解的方式中组织和部署它们。</p>
<p>render_template: render_template是Flask框架中的一个函数，将HTML模板和Python代码结合，以动态地生成Web页面。</p>
<p>redirect和url_for: redirect和url_for是Flask框架中的两个功能。redirect函数将用户重定向到另一个页面，而url_for函数获取应用程序路由的URL。</p>
<p>SQLAlchemy: SQLAlchemy是一个Python SQL工具包和ORM（Object Relational Mapper）。它使开发人员能够通过Python代码管理和交互数据库。</p>
<p>CompanyForm: CompanyForm是一个表单类，它使用Flask框架中的表单类构建器来定义一个表单。这样，开发人员可以在Flask应用程序中轻松创建表单，并将其发送到Web浏览器，收集数据并将其发送回服务器以进行处理。</p>
<p>创建一个名为 “app.py” 的文件，并将以下代码添加到其中：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="code"><pre><span class="line">from flask import Flask, render_template, redirect, url_for</span><br><span class="line">from flask_sqlalchemy import SQLAlchemy</span><br><span class="line">from forms import CompanyForm</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[&#x27;SECRET_KEY&#x27;] = &#x27;secret_key&#x27;</span><br><span class="line">app.config[&#x27;SQLALCHEMY_DATABASE_URI&#x27;] = &#x27;sqlite:///companies.db&#x27;</span><br><span class="line">db = SQLAlchemy(app)</span><br><span class="line"></span><br><span class="line">class Company(db.Model):</span><br><span class="line">    id = db.Column(db.Integer, primary_key=True)</span><br><span class="line">    name = db.Column(db.String(50), nullable=False)</span><br><span class="line">    website = db.Column(db.String(100))</span><br><span class="line">    location = db.Column(db.String(30))</span><br><span class="line">    description = db.Column(db.String(200))</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    def __repr__(self):</span><br><span class="line">        return self.name</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def index():</span><br><span class="line">    companies = Company.query.all()</span><br><span class="line">    return render_template(&#x27;index.html&#x27;, companies=companies)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/add&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def add_company():</span><br><span class="line">    form = CompanyForm()</span><br><span class="line">    if form.validate_on_submit():</span><br><span class="line">        new_company = Company(</span><br><span class="line">            name=form.name.data,</span><br><span class="line">            website=form.website.data,</span><br><span class="line">            location=form.location.data,</span><br><span class="line">            description=form.description.data</span><br><span class="line">        )</span><br><span class="line">        db.session.add(new_company)</span><br><span class="line">        db.session.commit()</span><br><span class="line">        return redirect(url_for(&#x27;index&#x27;))</span><br><span class="line">    return render_template(&#x27;add.html&#x27;, form=form)</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(debug=True)</span><br><span class="line">    </span><br></pre></td></tr></table></div></figure>





<p>创建一个名为 “forms.py” 的文件，并将以下代码添加到其中：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="code"><pre><span class="line">from flask_wtf import FlaskForm</span><br><span class="line">from wtforms import StringField, TextAreaField, SubmitField</span><br><span class="line">from wtforms.validators import DataRequired</span><br><span class="line"></span><br><span class="line">class CompanyForm(FlaskForm):</span><br><span class="line">    name = StringField(&#x27;Name&#x27;, validators=[DataRequired()])</span><br><span class="line">    website = StringField(&#x27;Website&#x27;)</span><br><span class="line">    location = StringField(&#x27;Location&#x27;)</span><br><span class="line">    description = TextAreaField(&#x27;Description&#x27;)</span><br><span class="line">    submit = SubmitField(&#x27;Add Company&#x27;)</span><br></pre></td></tr></table></div></figure>


<p>在根目录下创建一个名为 “templates” 的文件夹，并在其中创建以下三个 HTML 模板文件：</p>
<p>(1) “index.html” 模板文件</p>
<p>（2）”add.html“ 添加文件</p>
<p>（3）”base.html”</p>
<p>页面提交报错转移至<span class="exturl"><a class="exturl__link"   href="https://gitee.com/qinly_work/flasknav.git" >https://gitee.com/qinly_work/flasknav.git</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>运行 “app.py” 文件，并在浏览器中访问 “<span class="exturl"><a class="exturl__link"   href="http://localhost:5000/" >http://localhost:5000/</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>“ 即可查看公司导航网站。<br>这些代码例子希望可以帮助到你。</p>
<p>nginx配置</p>
<p>这是一个简单的 nginx 配置文件示例，可以用于将您的 Flask 应用程序部署到生产环境：</p>
<p>Copy code<br>server {<br>    # 监听本机 80 端口<br>    listen 80;<br>    # 添加您的域名或 IP 地址<br>    server_name example.com;<br>    # 定义您的项目的根目录<br>    root &#x2F;path&#x2F;to&#x2F;your&#x2F;project&#x2F;directory;<br>    # 配置访问日志和错误日志的路径<br>    access_log &#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log;<br>    error_log &#x2F;var&#x2F;log&#x2F;nginx&#x2F;error.log;<br>    # 配置静态文件的缓存时间<br>    expires 30d;<br>    # 定义对 “favicon.ico” 文件的请求的处理方式<br>    location &#x2F;favicon.ico {<br>        alias &#x2F;path&#x2F;to&#x2F;your&#x2F;project&#x2F;directory&#x2F;static&#x2F;favicon.ico;<br>    }<br>    # 配置应用程序的代理<br>    location &#x2F; {<br>        proxy_pass <span class="exturl"><a class="exturl__link"   href="http://127.0.0.1:5000/" >http://127.0.0.1:5000</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>;<br>        proxy_set_header Host $host;<br>        proxy_set_header X-Real-IP $remote_addr;<br>    }<br>}<br>在上面的配置文件中，我们使用 server 指令定义了该 nginx 服务器的基本配置信息。 listen 指令用于定义服务器将在其中监听的端口。 server_name 指令用于定义该服务器所关联的域名或 IP 地址。 root 指令指定我们应用程序的主目录所在位置，以便 nginx 能够访问其静态资源。 access_log 和 error_log 指令用于配置访问日志和错误日志的文件路径。 expires 指令用于对静态资源进行缓存。</p>
<p>接下来，我们配置了处理 favicon.ico 的位置，并将其路径指定为我们应用程序所在的目录。随后，我们使用 location &#x2F; 指令来处理所有其他请求。使用 proxy_pass 指令，它将请求转发给我们正在运行的 Flask 应用程序，它运行在本地主机（127.0.0.1）的默认端口上（5000）。 proxy_set_header 指令用于将不同的 HTTP 请求头信息传递给 Flask 应用程序。</p>
<p>当您完成了配置文件并将其保存为 &#x2F;etc&#x2F;nginx&#x2F;sites-available&#x2F;myproject 时，需要启用它并将其符号链接到 &#x2F;etc&#x2F;nginx&#x2F;sites-enabled&#x2F;myproject 。你需要执行以下命令启用它：</p>
<p>Copy code<br>sudo ln -s &#x2F;etc&#x2F;nginx&#x2F;sites-available&#x2F;myproject &#x2F;etc&#x2F;nginx&#x2F;sites-enabled&#x2F;<br>如果后面已经添加了链接，就需要先sudo unlink &#x2F;etc&#x2F;nginx&#x2F;sites-enabled&#x2F;myproject将其删除再执行上面的启用链接命令。 然后再执行此命令以重新加载 nginx 配置文件：</p>
<p>Copy code<br>sudo systemctl reload nginx<br>请根据您的实际应用情况配置您的 nginx 配置文件。</p>
<p>Website 直接显示域名</p>
<p>为了在打开您的网站或应用程序时直接显示域名而不是子路径或端口，请使用nginx中的location{}指令将请求重定向至您的 Flask 应用程序。</p>
<p>以下是将请求重定向至 Flask 应用程序的 Nginx 配置文件示例，可以将请求重定向至 Flask 应用程序：</p>
<p>Copy code<br>server {<br>    listen 80;<br>    server_name example.com;</p>
<pre><code>location / &#123;
    return 301 https://example.com$request_uri;
&#125;
</code></pre>
<p>}</p>
<p>server {<br>    listen 443 ssl;<br>    server_name example.com;</p>
<pre><code>ssl_certificate /path/to/your/cert;
ssl_certificate_key /path/to/your/key;

location / &#123;
    proxy_pass http://127.0.0.1:5000;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_redirect off;
&#125;
</code></pre>
<p>}<br>上述 Nginx 配置文件包含两个不同的部分。 第一个部分监听 80 端口上的传入请求，从而具有 server_name 为您的域名。 在这个段中，我们使用location &#x2F; 指令将所有请求重定向到我们的域名return 301 <span class="exturl"><a class="exturl__link"   href="https://example.com$request_uri./" >https://example.com$request_uri。</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> 这将生成一个 HTTP 301 永久重定向，并将所有未经请求的请求重定向到我们的应用程序之前的经由该域名的url。通常情况下，我们首选配置服务器在 80 端口上重定向 all （全部）请求到 https 协议的 443 端口上。</p>
<p>第二个部分监听 443 端口上的传入请求，并具有与前面相同的 server_name。 这个部分处理我们的 Flask 应用程序的实际请求，并使用location &#x2F;指令将请求转发给一个运行在本地 5000 端口上的 Flask 应用程序。</p>
<p>请确保在使用 HTTPS 的情况下为服务器配置 SSL&#x2F;TLS 证书。 我们可以通过如certbot之类的工具来获取免费的 SSL&#x2F;TLS 证书，从而保护数据的传输和隐私。</p>
<p>这样做后，您的应用程序将通过<span class="exturl"><a class="exturl__link"   href="http://example.com/" >http://example.com</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> 和<span class="exturl"><a class="exturl__link"   href="https://example.com/" >https://example.com</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> 表示，而不用在 URL 中显示端口号和子路径。如果你发现你的应用程序还显示端口号和子路径，可以尝试清空浏览器缓存，或者你还可以在页面中使用重定向。</p>
<p>补充知识：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="code"><pre><span class="line">Linux创建flask项目</span><br><span class="line"></span><br><span class="line">linux创建flask工程</span><br><span class="line">#创建虚拟目录</span><br><span class="line">mkdir testnav</span><br><span class="line">cd testnav/</span><br><span class="line">python3 -m venv venv</span><br><span class="line">source venv/bin/activate</span><br><span class="line">pip3 install flask</span><br><span class="line"></span><br><span class="line">#自动到处安装包</span><br><span class="line">pip3 freeze &gt; requirements.txt</span><br><span class="line">vim app.py </span><br><span class="line">flask app.py </span><br><span class="line">pip3 install flask_sqlalchemy</span><br><span class="line">pip3 install flask_wtf</span><br><span class="line">pip3 install wtforms.fields.html5</span><br><span class="line">pip install WTForms==2.3.3</span><br><span class="line">#运行</span><br><span class="line">flask run</span><br><span class="line">flask run --host=192.168.1.1</span><br><span class="line"></span><br><span class="line">flask的orm框架(SQLAlchemy)-创建表</span><br><span class="line">手动建表</span><br><span class="line"></span><br><span class="line">、</span><br><span class="line">id`    INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,</span><br><span class="line">    `username`    TEXT NOT NULL UNIQUE,</span><br><span class="line">    `password_hash`    TEXT NOT NULL</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">insert into user username &quot;tom&quot;;</span><br><span class="line"></span><br><span class="line">INSERT INTO USER (username,password_hash) VALUES (&#x27;tom&#x27;,&#x27;sadfadfasdfasfd&#x27;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>



<p>找不到table的时候 直接这样处理，会在instance里面生成库和表<br>(venv) [root@localhost nav]# flask shell<br>Python 3.8.1 (default, Feb  2 2023, 17:05:53)<br>[GCC 4.8.5 20150623 (Red Hat 4.8.5-44)] on linux<br>App: app<br>Instance: &#x2F;opt&#x2F;nav&#x2F;instance</p>
<blockquote>
<blockquote>
<blockquote>
<p>from app import db<br>db.create_all()</p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>import os<br>os.urandom(10)<br>b’\xc9NHrx0exb4\xce\x9c?”‘</p>
</blockquote>
</blockquote>
</blockquote>
<p>问：sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: link  falsk 不能自动创建这个表<br>答：<code>sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: link</code> 表示你正在查询或更新一个名为 <code>link</code> 的表，但该表不存在。这个错误通常是在表还没有被创建的情况下发生的。根据错误信息，我们可以看到这个问题发生在 SQLite 数据库中，而 Flask 框架不能自动创建这个表，所以你需要手动创建这个表。</p>
<p>你可以通过以下几个步骤来手动创建表：</p>
<ol>
<li><p>在你的应用程序中打开 Python 控制台或者一个新的 Python 文件。</p>
</li>
<li><p>导入数据库，例如：<code>from your_app import db</code>。</p>
</li>
<li><p>在 Python 交互式环境中运行 <code>db.create_all()</code> 命令。这将会根据你在应用程序中定义的数据库模型自动创建相应的表。</p>
</li>
</ol>
<figure class="highlight python"><div class="table-container"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 示例代码，假设你的链接模型为以下类：</span></span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">&#x27;SQLALCHEMY_DATABASE_URI&#x27;</span>] = <span class="string">&#x27;sqlite:///navigation.db&#x27;</span></span><br><span class="line">db = SQLAlchemy(app)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Link</span>(db.Model):</span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">50</span>), nullable=<span class="literal">False</span>)</span><br><span class="line">    url = db.Column(db.String(<span class="number">200</span>), nullable=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建所有表</span></span><br><span class="line">db.create_all()</span><br></pre></td></tr></table></div></figure>

<p>在上述示例代码中，我们首先为 Flask 应用程序定义了一个链接模型 <code>Link</code>，然后把该模型实例化到 <code>db</code> 实例中。最后，我们调用了 <code>create_all()</code> 方法来创建所有表，包括 <code>Link</code> 表。</p>
<p>如果你希望定制表的创建方式，可以查看 Flask SQLAlchemy 文档中的关于模型定义和迁移的内容，以了解如何手动创建和迁移表。</p>
]]></content>
  </entry>
  <entry>
    <title>flask制作网站导航</title>
    <url>/2023/03/07/flask%E5%88%B6%E4%BD%9C%E7%BD%91%E7%AB%99%E5%AF%BC%E8%88%AA/</url>
    <content><![CDATA[<p>flask开发一个网站导航<br>一个简单的Flask实现的网站导航的示例代码。它的实现依赖于SQLite数据库和Jinja2模板引擎。</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect, url_for</span><br><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建SQLite数据库并写入数据</span></span><br><span class="line">conn = sqlite3.connect(<span class="string">&#x27;links.db&#x27;</span>)</span><br><span class="line">c = conn.cursor()</span><br><span class="line">c.execute(<span class="string">&#x27;&#x27;&#x27;CREATE TABLE links (name text, url text)&#x27;&#x27;&#x27;</span>)</span><br><span class="line">c.execute(<span class="string">&quot;INSERT INTO links VALUES (&#x27;Google&#x27;, &#x27;https://www.google.com&#x27;)&quot;</span>)</span><br><span class="line">c.execute(<span class="string">&quot;INSERT INTO links VALUES (&#x27;Facebook&#x27;, &#x27;https://www.facebook.com&#x27;)&quot;</span>)</span><br><span class="line">c.execute(<span class="string">&quot;INSERT INTO links VALUES (&#x27;Twitter&#x27;, &#x27;https://www.twitter.com&#x27;)&quot;</span>)</span><br><span class="line">conn.commit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示导航网站</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    conn = sqlite3.connect(<span class="string">&#x27;links.db&#x27;</span>)</span><br><span class="line">    c = conn.cursor()</span><br><span class="line">    c.execute(<span class="string">&quot;SELECT * FROM links&quot;</span>)</span><br><span class="line">    links = c.fetchall()</span><br><span class="line">    conn.close()</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, links=links)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加新的网站到导航列表</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/add&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>():</span><br><span class="line">    name = request.form[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">    url = request.form[<span class="string">&#x27;url&#x27;</span>]</span><br><span class="line">    conn = sqlite3.connect(<span class="string">&#x27;links.db&#x27;</span>)</span><br><span class="line">    c = conn.cursor()</span><br><span class="line">    c.execute(<span class="string">&quot;INSERT INTO links VALUES (?, ?)&quot;</span>, (name, url))</span><br><span class="line">    conn.commit()</span><br><span class="line">    conn.close()</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></div></figure>

<p>在这个示例中，我们首先导入Flask、render_template、request、redirect和url_for等模块，以及sqlite3库。然后我们创建了一个SQLite数据库并插入了一些初始数据。我们定义了一个名为<code>index</code>的路由，用于显示导航网站，返回一个带有所有链接的HTML页面。我们定义了一个名为<code>add</code>的路由，它允许用户添加新链接到导航列表中，当用户提交表单时，链接会被保存到数据库并重定向到<code>/</code>根路由。</p>
<p>在HTML模板文件中，我们使用了Jinja2模板引擎，使用了for循环遍历链接列表来生成HTML代码。使用Python内置的SQLite数据库还可以进一步优化，这方便你可以高效地存储数据，并快速地查询和过滤数据。</p>
<p>除了添加CSS样式表和JavaScript代码，还可以使用前端框架或组件库来简化前端的开发和美化，这里给出一个使用Bootstrap框架的示例代码：</p>
<figure class="highlight html"><div class="table-container"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Required meta tags --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Bootstrap CSS --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">integrity</span>=<span class="string">&quot;sha384-KyZr5B0i5r5jTKI5ihonx+d6GVEYMEiQ0CioK9XWfsaS/G1lF2nJcPiwAvlbh/4K&quot;</span> <span class="attr">crossorigin</span>=<span class="string">&quot;anonymous&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Website Navigation<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;text-center mb-5&quot;</span>&gt;</span>Website Navigation<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-md-12&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;list-group&quot;</span>&gt;</span></span><br><span class="line">                &#123;% for link in links %&#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;list-group-item&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot; &quot;</span> <span class="attr">class</span>=<span class="string">&quot;text-decoration-none fs-5&quot;</span>&gt;</span>&#123;&#123; link[0] &#125;&#125;&lt;/a &gt;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                &#123;% endfor %&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">hr</span> <span class="attr">class</span>=<span class="string">&quot;my-5&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-md-12&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;mb-4&quot;</span>&gt;</span>Add a new website:<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">action</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;add&#x27;) &#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group mb-3&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;name&quot;</span>&gt;</span>Name:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">id</span>=<span class="string">&quot;name&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group mb-3&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;url&quot;</span>&gt;</span>URL:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;url&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">id</span>=<span class="string">&quot;url&quot;</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary btn-lg&quot;</span>&gt;</span>Add<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Optional JavaScript --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- jQuery first, then Popper.js, then Bootstrap JS --&gt;</span>\</span><br></pre></td></tr></table></div></figure>

<p>图示</p>
<p><img src="https://raw.githubusercontent.com/orangefei/imgbed/master/1678182837796.jpg"></p>
]]></content>
  </entry>
  <entry>
    <title>flask基础</title>
    <url>/2023/03/06/flask%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="code"><pre><span class="line">初始Flask</span><br><span class="line">使用pycharm(相关安装配置可查看以前的博文)新建flask项目</span><br><span class="line"></span><br><span class="line">解释一下项目的整体结构，从上图可以看到，新建的最基本的项目会包含static和tamplate两个文件夹和一个与包同名的py文件</span><br><span class="line">    static通常存储静态文件，css\js等</span><br><span class="line">    template默认存放模板，什么是模板？这部分详见Flask模板部分</span><br><span class="line">我们知道在MVC框架中包含三个部分：Model、View、Controller</span><br><span class="line">严格地说，Flask不是MVC架构的框架，因为他没有内置数据模型的支持。</span><br><span class="line">其他模块了解：</span><br><span class="line">MVC</span><br><span class="line">    模型（Model）：数据保存</span><br><span class="line">    视图（View）：用户界面。</span><br><span class="line">    控制器（Controller）：业务逻辑</span><br><span class="line">通信流程：</span><br><span class="line">    用户通过UI界面的交互触发View响应，View发送指令给Controller</span><br><span class="line">    Controller完成业务逻辑之后，要求Model更新数据</span><br><span class="line">    Model将新数据发送给View，要求View更新，更新后用户得到反馈</span><br><span class="line"></span><br><span class="line">mvvc</span><br><span class="line">传统的前端会将数据手动渲染到页面上，MVVM模式不需要用户手动操作DOM元素，将数据绑定到viewModel层上，会自动将数据渲染到页面中。</span><br><span class="line">视图变化会通知viewModel层更新数据，viewModel就是MVVM模式的桥梁。</span><br><span class="line">数据驱动数据流动时双向的，model——&gt;viewModel&lt;——&gt;view</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">代码层：</span><br><span class="line">    from flask import Flask</span><br><span class="line">    app = Flask(__name__)</span><br><span class="line">     </span><br><span class="line">    @app.route(&#x27;/&#x27;)</span><br><span class="line">    def hello_world():</span><br><span class="line">        return &#x27;Hello World!&#x27;</span><br><span class="line">     </span><br><span class="line">    if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">        app.run()</span><br><span class="line"></span><br><span class="line">简单解释一下这个示例代码：</span><br><span class="line">传入Flask类构造方法的第一个参数是模块或者包的名称，此处用了当前模块__name__</span><br><span class="line">为函数附加app.route()装饰器，并传入URL规则作为参数，必须以‘/‘开始，可以绑定多个URL也可以是动态&lt;&gt;的，这样URL就和函数建立了关联，这个过程就是注册路由，这个函数被称为视图函数</span><br><span class="line">通过run()方法启动Flask程序，这里有一个调试模式，就是服务器会在代码修改以后自动重新载入，这样就不需要每次修改程序以后手动地去重启它。主要有如下两种方式(绝对不可以用于生产环境)</span><br><span class="line">    方式一：直接在应用对象上设置</span><br><span class="line">        app.debug = True</span><br><span class="line">        app.run()</span><br><span class="line">    方式二：作为run方法的一个参数传入</span><br><span class="line">    app.run(debug=True)</span><br><span class="line"></span><br><span class="line">python里面__(双下划线)和_(单下划线)的区别</span><br><span class="line">拓展一</span><br><span class="line">_单下划线本身可以用作临时变量，比如：for _ in rang(n)；</span><br><span class="line">_xx(变量前的单下划线)，用于声明私有化属性和方法，但实际上python本身没有真正的私有方法，所以这只是一个申明。form 包名 import * 禁止导入，</span><br><span class="line">类对象和子类可以访问，使用对象._变量名调用；</span><br><span class="line"></span><br><span class="line">__xx(变量前的双下划线)，避免与子类中的属性命名冲突，同时双下划线开头的方法不能被重写，只允许类内部使用，无法在外部直接访问，应使用对象._类名__变量名调用；</span><br><span class="line"></span><br><span class="line">__xx__(变量前后的双下划线)，用于定义类的魔法属性/方法，例如：__init__()当变量被创建初始化调用,__new__()用来创建实例、__str__等，无法直接调用；</span><br><span class="line"></span><br><span class="line">Flask与HTTP</span><br><span class="line">Flask模板</span><br><span class="line">基本用法</span><br><span class="line">模板：包含固定内容和动态部分的可重用文件。</span><br><span class="line">模板引擎的作用：读取并执行模板中的特殊语法标记，并根据传入的数据将变量替换为实际值，输出到最终的HTML页面。这个过程也被称为渲染。</span><br><span class="line">Flask默认的模板引擎是Jinja2（支持&quot;.&quot;获取变量的属性），常见的三种定界符：</span><br><span class="line">    语句。如if判断、for循环等：&#123;% ... %&#125;。注意：语句结束时，需要添加结束标签</span><br><span class="line">    表达式。如字符串、变量、函数调用等：&#123;&#123; ... &#125;&#125;</span><br><span class="line">    注释。&#123;# ... #&#125;</span><br><span class="line"></span><br><span class="line"> 这里给出一个简单的示例watchlist.html。其中user是自建的虚拟数据</span><br><span class="line">    user=&#123;</span><br><span class="line">        &#x27;username&#x27;:&#x27;Grey Li&#x27;,</span><br><span class="line">        &#x27;bio&#x27;:&#x27;A boy who loves movies and music&#x27;,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &lt;!DOCTYPE html&gt;</span><br><span class="line">    &lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">        &lt;title&gt;&#123;&#123; user.username &#125;&#125;&#x27;s Watchlist&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; user.username &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &#123;% if user.bio %&#125;</span><br><span class="line">        &lt;i&gt;&#123;&#123; user.bio &#125;&#125;&lt;/i&gt;</span><br><span class="line">    &#123;% else %&#125;</span><br><span class="line">        &lt;i&gt;This user has not provided a bio.&lt;/i&gt;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">    &#123;# 下面是电影清单 #&#125;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">    &lt;/html&gt;</span><br><span class="line"></span><br><span class="line">在视图中渲染模板时，使用render_template()函数，传入模板的文件名作为参数，还可以将关键字参数的形式传入模板中实用的变量值。</span><br><span class="line">当然Jinja2还可以传入字符串、列表、字典；函数、类、类实例</span><br><span class="line">Flask会默认在根目录下的template文件夹下寻找模板文件</span><br><span class="line">教程里面提到：如果应用是一个模板，这个文件夹应该和模板同级；如果是一个包，那么这个文件夹作为包的子目录。</span><br><span class="line">对之前的初始代码进行修改丰富</span><br><span class="line">    from flask import Flask, render_template</span><br><span class="line">     </span><br><span class="line">    app = Flask(__name__)</span><br><span class="line">     </span><br><span class="line">    user = &#123;</span><br><span class="line">        &#x27;username&#x27;:&#x27;Grey Li&#x27;,</span><br><span class="line">        &#x27;bio&#x27;:&#x27;A boy who loves movies and music&#x27;,</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    @app.route(&#x27;/&#x27;)</span><br><span class="line">    def hello_world():</span><br><span class="line">        return &#x27;Hello World!&#x27;</span><br><span class="line">     </span><br><span class="line">    @app.route(&#x27;/watchlist/&#x27;)</span><br><span class="line">    def watchlist():</span><br><span class="line">        return render_template(&quot;watchlist.html&quot;, user=user)</span><br><span class="line">     </span><br><span class="line">    if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">        app.run()</span><br><span class="line"></span><br><span class="line">运行以后，前台显示如下</span><br><span class="line">辅助工具之上下文</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">辅助工具之全局对象</span><br><span class="line">Jinja2提供的内置全局变量</span><br><span class="line">    range([start,]stop[,step])，同python中range的用法</span><br><span class="line">    lipsum(n=5, html=True,min=20,max=100，生成随机文本，可用于测试填充页面</span><br><span class="line">    dict(**items)，同python中字典的用法</span><br><span class="line">Flask内置的全局变量</span><br><span class="line">    url_for()，生成URL的函数</span><br><span class="line">        &lt;a href=&quot;&#123;&#123; url_for(&#x27;index&#x27;) &#125;&#125;&quot;&gt;&amp;larr; Return&lt;/a&gt;</span><br><span class="line">        &#123;#在watchlist.html模板文件中，上面那句话可以等价于下面这句话 #&#125;</span><br><span class="line">        &lt;a href=&quot;/&quot;&gt;&amp;larr; Return&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">    get_flashes_messages()，获取flsh消息的函数。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  <entry>
    <title>flask开发webssh</title>
    <url>/2023/03/06/flask%E5%BC%80%E5%8F%91webssh/</url>
    <content><![CDATA[<figure class="highlight python"><div class="table-container"><table><tr><td class="code"><pre><span class="line">Flask是一种基于Python的轻量级Web框架，它可以用于构建中小型应用程序。WebSSH是一种使用Web浏览器访问SSH远程主机的Web应用程序，并提供了一个适用于终端的Web界面。当这两种技术结合在一起时，就可以开发一个WebSSH应用程序，它可以让用户使用Web浏览器访问SSH远程主机，并提供了一个适用于终端的Web界面。</span><br><span class="line"></span><br><span class="line">下面是一些实现WebSSH的基本思路和步骤：</span><br><span class="line"><span class="number">1.</span> 使用Flask构建Web应用程序，并在其中添加一个SSH终端界面。</span><br><span class="line"><span class="number">2.</span> 使用Python的paramiko库建立与SSH服务器的连接，并在Flask应用程序中调用它。</span><br><span class="line"><span class="number">3.</span> 使用JavaScript编写终端界面的前端代码，以便与Flask应用程序通信，并使用WebSockets实现实时数据传输。</span><br><span class="line"><span class="number">4.</span> 将Flask应用程序部署到云服务器上，并确保在云服务器上安装了必要的软件和依赖项。</span><br><span class="line"><span class="number">5.</span> 配置Flask应用程序的路由和端口，以便用户可以通过Web浏览器访问SSH终端界面。</span><br><span class="line"><span class="number">6.</span> 在用户身份验证方面，可以使用基本认证、OAuth2<span class="number">.0</span>等机制来保护用户的安全，防止随意访问。</span><br><span class="line"><span class="number">7.</span> 配置Flask应用程序的日志记录和监控，以便及时发现和排除异常和错误。</span><br><span class="line"><span class="number">8.</span> 根据具体需求和场景，可以添加一些自定义的功能和扩展，如数据加密、数据备份、会话管理等。</span><br><span class="line">以上就是基于Flask实现WebSSH的一些基本思路和步骤。需要注意的是，由于SSH是一种比较敏感的网络协议，因此在使用过程中需要格外注意安全性和保密性，以确保用户数据和系统安全。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight python"><div class="table-container"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> 安装必要的库</span><br><span class="line"></span><br><span class="line">​```</span><br><span class="line">pip install flask paramiko eventlet</span><br><span class="line">​```</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> 导入所需的库</span><br><span class="line"></span><br><span class="line">​```python</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template</span><br><span class="line"><span class="keyword">from</span> flask_socketio <span class="keyword">import</span> SocketIO, send, emit</span><br><span class="line"><span class="keyword">import</span> paramiko</span><br><span class="line"><span class="keyword">import</span> eventlet</span><br><span class="line">​```</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> 定义Flask应用程序</span><br><span class="line"></span><br><span class="line">​```python</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="string">&#x27;secret!&#x27;</span> <span class="comment"># 配置应用程序密钥，用于加密 cookies</span></span><br><span class="line">socketio = SocketIO(app) <span class="comment"># 初始化 SocketIO 实例</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>) </span><span class="comment"># 定义根路由</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>) <span class="comment"># 返回 index.html 模板</span></span><br><span class="line">​```</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> 编写连接 SSH 主机并打开会话的函数</span><br><span class="line"></span><br><span class="line">​```python</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">open_ssh_session</span>(<span class="params">hostname, username, password</span>):</span><br><span class="line">    ssh = paramiko.SSHClient()</span><br><span class="line">    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())</span><br><span class="line">    ssh.connect(hostname, username=username, password=password)</span><br><span class="line">    channel = ssh.invoke_shell()</span><br><span class="line">    <span class="keyword">return</span> channel, ssh</span><br><span class="line">​```</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span> 在连接成功后，启动一个异步任务接收来自 SSH 主机的消息，并将它们发送到客户端</span><br><span class="line"></span><br><span class="line">​```python</span><br><span class="line"><span class="meta">@socketio.on(<span class="params"><span class="string">&#x27;connect&#x27;</span></span>) </span><span class="comment"># 监听 socket 连接事件</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_connect</span>():</span><br><span class="line">    hostname = <span class="string">&#x27;&lt;your_hostname_here&gt;&#x27;</span></span><br><span class="line">    username = <span class="string">&#x27;&lt;your_username_here&gt;&#x27;</span></span><br><span class="line">    password = <span class="string">&#x27;&lt;your_password_here&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line">    channel, ssh = open_ssh_session(hostname, username, password) <span class="comment"># 连接 SSH 主机并打开终端</span></span><br><span class="line">    fd = channel.fileno() <span class="comment"># 获取终端描述符</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将当前任务挂起，等待来自 SSH 主机的数据</span></span><br><span class="line">    <span class="comment"># 一旦有数据到达，将其发送到客户端</span></span><br><span class="line">    <span class="comment"># 这样我们就可以通过指令直接与 SSH 主机进行交互，实现了远程 SSH 连接的功能</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> channel.closed:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># 如果终端有数据，立即发送到客户端</span></span><br><span class="line">            <span class="keyword">if</span> channel.recv_ready():</span><br><span class="line">                socketio.emit(<span class="string">&#x27;output&#x27;</span>, channel.recv(<span class="number">1024</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">            eventlet.sleep(<span class="number">0.1</span>) <span class="comment"># 等待下一条消息</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(e)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 终止 SSH 会话</span></span><br><span class="line">    channel.close()</span><br><span class="line">    ssh.close()</span><br><span class="line">​```</span><br><span class="line"></span><br><span class="line"><span class="number">6.</span> 编写前端模板</span><br><span class="line"></span><br><span class="line">​```html</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;WebSSH&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;h1&gt;WebSSH Client&lt;/h1&gt;</span><br><span class="line">    &lt;div <span class="built_in">id</span>=<span class="string">&quot;output&quot;</span>&gt;&lt;/div&gt;</span><br><span class="line">    &lt;form <span class="built_in">id</span>=<span class="string">&quot;command-form&quot;</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">input</span> <span class="built_in">id</span>=<span class="string">&quot;input&quot;</span> <span class="built_in">type</span>=<span class="string">&quot;text&quot;</span> size=<span class="string">&quot;50&quot;</span>/&gt;</span><br><span class="line">      &lt;<span class="built_in">input</span> <span class="built_in">type</span>=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;Send&quot;</span>/&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script src=<span class="string">&quot;//code.jquery.com/jquery-1.11.1.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=<span class="string">&quot;//cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.3/socket.io.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">      // 建立 socket 连接</span><br><span class="line">      var socket = io.connect(<span class="string">&#x27;http://&#x27;</span> + document.domain + <span class="string">&#x27;:&#x27;</span> + location.port);</span><br><span class="line"></span><br><span class="line">      // 当 socket 连接成功时，触发回调函数</span><br><span class="line">      socket.on(<span class="string">&#x27;connect&#x27;</span>, function() &#123;</span><br><span class="line">        console.log(<span class="string">&#x27;Socket connected&#x27;</span>);</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      // 接收后端发送来的终端输出，并将其显示在网页上</span><br><span class="line">      socket.on(<span class="string">&#x27;output&#x27;</span>, function(msg) &#123;</span><br><span class="line">        $(<span class="string">&#x27;#output&#x27;</span>).append(msg.replace(/</span><br><span class="line">/g, <span class="string">&#x27;&lt;br&gt;&#x27;</span>));</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      // 当用户单击表单提交按钮时，将输入的指令发送给后端处理</span><br><span class="line">      $(<span class="string">&#x27;form#command-form&#x27;</span>).submit(function(event) &#123;</span><br><span class="line">        event.preventDefault();</span><br><span class="line">        var command = $(<span class="string">&#x27;#input&#x27;</span>).val();</span><br><span class="line">        socket.emit(<span class="string">&#x27;command&#x27;</span>, command);</span><br><span class="line">        $(<span class="string">&#x27;#input&#x27;</span>).val(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">​```</span><br><span class="line"></span><br><span class="line"><span class="number">7.</span> 运行应用程序</span><br><span class="line"></span><br><span class="line">​```</span><br><span class="line">python3 app.py</span><br><span class="line">​```</span><br><span class="line"></span><br><span class="line"><span class="number">8.</span> 打开浏览器，访问 http://localhost:<span class="number">5000</span>，即可看到 WebSSH 终端界面。</span><br><span class="line">注意：上述代码仅供参考，实际上线时需要考虑更多的安全性测试和实现细节问题。</span><br><span class="line"></span><br><span class="line">排错</span><br><span class="line">ModuleNotFoundError: No module named <span class="string">&#x27;flask_socketio&#x27;</span></span><br><span class="line">这个错误提示表明您的Python环境中缺少了`flask_socketio`模块。您需要先安装该模块：</span><br><span class="line"></span><br><span class="line">​```</span><br><span class="line">pip install flask-socketio</span><br><span class="line">​```</span><br><span class="line"></span><br><span class="line">如果您使用的是Python3，则可以使用下面的命令安装：</span><br><span class="line"></span><br><span class="line">​```</span><br><span class="line">pip3 install flask-socketio</span><br><span class="line">​```</span><br><span class="line"></span><br><span class="line">安装完成后，再次运行您的Flask应用程序即可。</span><br><span class="line"></span><br><span class="line">AssertionError: View function mapping <span class="keyword">is</span> overwriting an existing endpoint function: index</span><br><span class="line">答：这个错误提示表明您在Flask应用程序中定义了重复的视图函数，即出现了同名的视图函数。出现这种情况会导致Flask无法正常解析请求路由，从而抛出上述的`AssertionError`异常。</span><br><span class="line"></span><br><span class="line">解决方法是修改您的视图函数名称，确保每个视图函数名称都是唯一的。</span><br><span class="line"></span><br><span class="line">例如，如果当前定义了两个名为`index`的视图函数，您可以将其中一个视图函数的名称修改为其他名称，例如`home`，如下所示：</span><br><span class="line"></span><br><span class="line">​```python</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/home&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;This is your home page!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;This is your index page!&#x27;</span></span><br><span class="line">​```</span><br><span class="line"></span><br><span class="line">这样就可以避免同名视图函数的冲突，从而解决上述的`AssertionError`异常。</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

]]></content>
      <tags>
        <tag>flask</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2023/02/26/hello-world/</url>
    <content><![CDATA[<p>Welcome to <span class="exturl"><a class="exturl__link"   href="https://hexo.io/" >Hexo</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>! This is your very first post. Check <span class="exturl"><a class="exturl__link"   href="https://hexo.io/docs/" >documentation</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> for more info. If you get any problems when using Hexo, you can find the answer in <span class="exturl"><a class="exturl__link"   href="https://hexo.io/docs/troubleshooting.html" >troubleshooting</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> or you can ask me on <span class="exturl"><a class="exturl__link"   href="https://github.com/hexojs/hexo/issues" >GitHub</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</p>

        <h2 id="Quick-Start"   >
          <a href="#Quick-Start" class="heading-link"><i class="fas fa-link"></i></a><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2>
      
        <h3 id="Create-a-new-post"   >
          <a href="#Create-a-new-post" class="heading-link"><i class="fas fa-link"></i></a><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3>
      <figure class="highlight bash"><div class="table-container"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></div></figure>

<p>More info: <span class="exturl"><a class="exturl__link"   href="https://hexo.io/docs/writing.html" >Writing</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h3 id="Run-server"   >
          <a href="#Run-server" class="heading-link"><i class="fas fa-link"></i></a><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3>
      <figure class="highlight bash"><div class="table-container"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></div></figure>

<p>More info: <span class="exturl"><a class="exturl__link"   href="https://hexo.io/docs/server.html" >Server</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h3 id="Generate-static-files"   >
          <a href="#Generate-static-files" class="heading-link"><i class="fas fa-link"></i></a><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3>
      <figure class="highlight bash"><div class="table-container"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></div></figure>

<p>More info: <span class="exturl"><a class="exturl__link"   href="https://hexo.io/docs/generating.html" >Generating</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h3 id="Deploy-to-remote-sites"   >
          <a href="#Deploy-to-remote-sites" class="heading-link"><i class="fas fa-link"></i></a><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3>
      <figure class="highlight bash"><div class="table-container"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></div></figure>

<p>More info: <span class="exturl"><a class="exturl__link"   href="https://hexo.io/docs/one-command-deployment.html" >Deployment</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
]]></content>
  </entry>
  <entry>
    <title>hexo个人博客搭建二</title>
    <url>/2023/02/27/hexo%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E4%BA%8C/</url>
    <content><![CDATA[<figure class="highlight python"><div class="table-container"><table><tr><td class="code"><pre><span class="line">个人快速建站的几种方法：</span><br><span class="line">一、</span><br><span class="line">hexo+gitee/github</span><br><span class="line">本博客采用GitHub，另外申请的付费域名</span><br><span class="line">https://www.namesilo.com</span><br><span class="line">申请之后，删除多余部分只留a记录和cname记录</span><br><span class="line"></span><br><span class="line">二、生成好的pbulic目录传到oss,配置一个备案成功的域名即可访问，也算低成本的考虑方案</span><br><span class="line">hexo+oss 本地备案</span><br><span class="line">三、</span><br><span class="line">购买搬瓦工之类的vps,部署系统+node环境，申请对应的域名</span><br><span class="line">hexo+vps+namesilo</span><br><span class="line">四、参考以下站点，操作</span><br><span class="line">https://www.cnblogs.com/martin-<span class="number">1</span>/p/<span class="number">14934029.</span>html</span><br><span class="line">https://zhuanlan.zhihu.com/p/<span class="number">582629584</span></span><br><span class="line">https://zhuanlan.zhihu.com/p/<span class="number">350760097</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">五、遇到问题</span><br><span class="line">每次配置 custom domain 之后，再次 hexo deploy 之后，custom domain 会被重置失效。</span><br><span class="line">解决方案</span><br><span class="line">在 hexo 生成的博客的 source 目录下新建一个 CNAME 文件，然后在这个文件中填入你的域名，这样就不会每次发布之后，</span><br><span class="line">gitpage 里的 custom domain 都被重置掉啦。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">六、图片导入</span><br><span class="line">本地配置导入typora</span><br><span class="line"></span><br><span class="line">采用“图床”概念，项目中通过绝对路径引入图片信息。</span><br><span class="line">可借助阿里云、腾讯云、路过图床、七牛云等构建自定义图床进行引入</span><br><span class="line"></span><br><span class="line">tips: </span><br><span class="line">此博客使用的是GitHub作为图床，使用过程中发现，在typora里面直接贴url可以访问，如果在Python模块里面贴图片是无法访问的</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>



<p>namesilo图示:</p>
<p><img src="https://raw.githubusercontent.com/orangefei/imgbed/master/WechatIMG12870.png"></p>
<p><img src="https://raw.githubusercontent.com/orangefei/imgbed/master/WechatIMG12871.png"></p>
]]></content>
      <tags>
        <tag>linux</tag>
        <tag>github</tag>
      </tags>
  </entry>
  <entry>
    <title>nginxupstream</title>
    <url>/2023/03/01/nginxupstream/</url>
    <content><![CDATA[<figure class="highlight python"><div class="table-container"><table><tr><td class="code"><pre><span class="line">nginx负载均衡的三种方式主要是轮询模式、weight权重模式、ip_hash。</span><br><span class="line">当一台服务器的单位时间内的访问量越大时，服务器压力就越大，大到超过自身承受能力时，服务器就会崩溃。为了避免服务器崩溃，让用户有更好的体验，我们通过负载均衡的方式来分担服务器压力。</span><br><span class="line"><span class="number">1</span>、轮询模式（默认） </span><br><span class="line">每个请求按时间顺序逐一分配到不同的后端服务器，如果后端服务器down掉，能自动剔除。</span><br><span class="line">适合服务器配置相当，无状态且短平快的服务使用。也适用于图片服务器集群和纯静态页面服务器集群。</span><br><span class="line"><span class="number">2</span>、weight权重模式</span><br><span class="line">这种方式比较灵活，当后端服务器性能存在差异的时候，通过配置权重，可以让服务器的性能得到充分发挥，有效利用资源。weight和访问比率成正比，用于后端服务器性能不均的情况。权重越高，在被访问的概率越大</span><br><span class="line"><span class="number">3</span>、ip_hash</span><br><span class="line">上述weight权重模式方式存在一个问题，在负载均衡系统中，假如用户在某台服务器上登录了，那么该用户第二次请求的时候，因为我们是负载均衡系统，每次请求都会重新定位到服务器集群中的某一个，那么已经登录某一个服务器的用户再重新定位到另一个服务器，其登录信息将会丢失，这样显然是不妥的。</span><br><span class="line">可以采用ip_hash指令解决这个问题，如果客户已经访问了某个服务器，当用户再次访问时，会将该请求通过哈希算法，自动定位到该服务器。</span><br><span class="line">每个请求按访问ip的<span class="built_in">hash</span>结果分配，这样每个访客固定访问一个后端服务器，可以解决session不能跨服务器的问题。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Nginx只有当有访问时后，才发起对后端节点探测。如果本次请求中，节点正好出现故障，Nginx依然将请求转交给故障的节点,然后再转交给健康的节点处理。</span><br><span class="line">所以不会影响到这次请求的正常进行。但是会影响效率,因为多了一次转发,而且自带模块无法做到预警。</span><br><span class="line">nginx主动检查</span><br><span class="line">主动地健康检查，nignx定时主动地去ping后端的服务列表，当发现某服务出现异常时，把该服务从健康列表中移除，当发现某服务恢复时，又能够将该服务加回健康列表中。</span><br><span class="line">淘宝有一个开源的实现nginx_upstream_check_module模块</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

]]></content>
      <tags>
        <tag>nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo搭建个人博客系统</title>
    <url>/2023/02/27/hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F/</url>
    <content><![CDATA[<figure class="highlight python"><div class="table-container"><table><tr><td class="code"><pre><span class="line">开始安装Hexo</span><br><span class="line"><span class="number">1</span>、安装hexo</span><br><span class="line"></span><br><span class="line">npm install -g hexo-cli</span><br><span class="line">或者</span><br><span class="line">cnpm install -g hexo-cli</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、初始化hexo，新建存储博客的文件夹</span><br><span class="line">hexo init myblog</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、进入文件夹，安装一下npm</span><br><span class="line">cd myblog</span><br><span class="line">npm install</span><br><span class="line"><span class="number">4</span>、启动服务站点</span><br><span class="line">hexo g </span><br><span class="line">hexo server</span><br><span class="line"><span class="number">5</span>、重要文件注释</span><br><span class="line">——config.yml 网站配置信息</span><br><span class="line">package.json 应用程序信息</span><br><span class="line">scaffolds 模板文件夹（存放文章）</span><br><span class="line">source 存放用户资源文件夹</span><br><span class="line">thems 主题文件夹</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Gitee上建站访问</span><br><span class="line">可在github或者gitee上建站，gitee国内访问快一些</span><br><span class="line"><span class="number">1</span>、新建仓库</span><br><span class="line">格式必须是：用户名+.gitee.io 只有这样，将来要部署到Gite e page的时候，才会被识别，</span><br><span class="line">也就是xxxx.gitee.io，其中xxx就是你注册Gitee的用户名。</span><br><span class="line"><span class="number">2</span>、将hexo博客站点上传到gitee上</span><br><span class="line">这里需要安装一个hexo的上传插件deploy-git</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line"><span class="number">3</span>、修改hexo配置文件指定仓库路径</span><br><span class="line">可在文件夹中直接打开文件，也可通过vim直接编</span><br><span class="line">找到Deployment加上（注意空格）</span><br><span class="line">deploy:</span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  repo: 你的仓库路径</span><br><span class="line">  branch: master <span class="comment">#github现在已更改为main</span></span><br><span class="line"><span class="number">4</span>、推送hexo站点文件</span><br><span class="line">之后就可以推送博客站点到gitee上了</span><br><span class="line">推送命令</span><br><span class="line">hexo d</span><br><span class="line">扩展：</span><br><span class="line">其中 hexo clean清除了你之前生成的东西，也可以不加。</span><br><span class="line">hexo generate 顾名思义，生成静态文章，可以用 hexo g缩写</span><br><span class="line">hexo deploy 部署文章，可以用hexo d缩写</span><br><span class="line"></span><br><span class="line">推送中会要求输入gitee的用户名和密码（如果不想每次都输可以配置ssh，我这里就不做演示了）</span><br><span class="line">然后就可以看到gitee上有推上来的文件</span><br><span class="line"><span class="number">5</span>、配置Pages服务</span><br><span class="line">目前我们站点还无法访问需要开启Gitee Pages（gitee需要开启(目前需要四个身份证验证)，github不需要）</span><br><span class="line">审核通过启动我们就可以访问啦。</span><br><span class="line">gitee上传新文件之后，需要手动更新一下，更新后的页面才会生效</span><br><span class="line">标记：如果觉得这个访问路径太长了，我们可以去买一个域名，将该路径绑定到域名上，即可通过域名访问了。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">6</span>、安装插件</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">更换主题 到GitHub上搜索hexo主题或者hero自带的主题https://hexo.io/themes/</span><br><span class="line">创建新的页面</span><br><span class="line">hexo new page about</span><br><span class="line">hexo new page categories</span><br><span class="line">categories:</span><br><span class="line">        - [Linux]</span><br><span class="line">        - [Linux, tools]</span><br><span class="line">        - [Python,web]</span><br><span class="line">        - [Database]</span><br><span class="line"><span class="comment"># 多级分类写法</span></span><br><span class="line"></span><br><span class="line">hexo new page tags</span><br><span class="line">tags:</span><br><span class="line">- jQuery</span><br><span class="line">- 表格</span><br><span class="line">- 表单验证</span><br><span class="line"><span class="comment">#支持这种格式</span></span><br><span class="line"></span><br><span class="line">报错处理</span><br><span class="line">extends ./_layout.pug block content include ./_partials/post/post-<span class="built_in">list</span>.pug <span class="keyword">if</span> theme.post_list.paginate.home include ./_partials/widgets/paginator.pug </span><br><span class="line">npm install hexo-renderer-pug --save</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

]]></content>
      <tags>
        <tag>github</tag>
      </tags>
  </entry>
  <entry>
    <title>python基础</title>
    <url>/2023/03/07/python%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<p>Python是一种高级编程语言，具有易于学习、易于编写、可读性强、可扩展性好等特性，被广泛应用于Web应用程序、数据科学、人工智能、自然语言处理、网络编程等领域。在本篇博客中，我们将从以下几个方面介绍Python的特点和应用。</p>
<ol>
<li>语言特性</li>
</ol>
<p>Python的语法简洁，使用缩进代替花括号，使得代码更加清晰易读。它也是一种解释型语言，不需要编译，可以在不同的平台上运行。Python有各种不同的应用场景，包括Web开发、数据科学、人工智能、自然语言处理、网络编程等。在这些领域中，Python都有着广泛的应用。</p>
<ol start="2">
<li>应用场景</li>
</ol>
<p>Python的应用场景主要包括以下几个方面。</p>
<p>2.1 Web开发</p>
<p>通过使用一些Web框架，如Django、Flask等，可以使用Python来开发Web应用程序。这些框架提供了各种工具和功能，使得开发者可以更加高效地构建和调试Web应用程序。</p>
<p>2.2 数据科学</p>
<p>Python在数据科学领域中的应用越来越广泛。NumPy、Pandas、Matplotlib等库提供了各种各样的数据结构和分析工具，使得Python成为了数据分析和可视化的重要工具。</p>
<p>2.3 人工智能</p>
<p>Python也被广泛应用于人工智能领域，特别是深度学习等方面。TensorFlow、PyTorch等库提供了各种各样的神经网络模型和优化算法，使得Python成为了深度学习领域的主流语言。</p>
<p>2.4 自然语言处理</p>
<p>Python也是自然语言处理领域中的重要工具。NLTK、SpaCy等库提供了各种自然语言处理工具和算法，使得开发者可以更加轻松地处理和分析文本数据。</p>
<p>2.5 网络编程</p>
<p>Python也可以用于网络编程，在Socket编程、爬虫等方面有广泛的应用。通过使用一些网络编程库，如Requests、Scrapy等，可以轻松地进行网络通信和数据抓取等工作。</p>
<ol start="3">
<li>优缺点</li>
</ol>
<p>Python的优点主要包括易于学习、易于编写、可读性强、可扩展性好等方面。Python还有丰富的第三方库支持，包括NumPy、Pandas、Matplotlib、TensorFlow等用于数据科学和机器学习的重要库。</p>
<p>Python的缺点主要包括执行速度较慢、无法与C&#x2F;C++这样的编译型语言相比，并且由于其动态类型特性，代码缺乏一定的类型安全性。</p>
<ol start="4">
<li>Python社区与资源</li>
</ol>
<p>Python有着广泛的社区和资源支持，包括Stack Overflow、GitHub等网站上的大量资源和社区，可以帮助Python开发者解决问题。同时，Python社区也推出了各种学习资源和书籍，如《Python基础教程》、《Python核心编程》等，供初学者参考。</p>
<p>总之，Python是一种易于学习且功能强大的编程语言，可以应用于各种领域。对于初学者，Python的学习曲线非常平缓，易于上手。对于专业开发者，Python具有质量高、效率高、可读性强等特点，被广泛认可和应用。</p>
<p>python flask和Django的区别<br>Python Flask和Django是两个流行的web框架，它们都基于Python语言，但在设计思想、功能及适用范围方面有一定的区别。下面是它们的主要区别：</p>
<ol>
<li>设计思想</li>
</ol>
<p>Flask的设计思想是”micro”（微型）和”minimalist”（极简），它只提供了基本的web服务功能，其他的功能需要引入第三方库来实现。相比之下，Django的设计思想是”batteries included”（一揽子服务），它提供了一个完整的解决方案，包括ORM、模板引擎、管理后台等。</p>
<ol start="2">
<li>功能</li>
</ol>
<p>Flask的灵活性非常高，因为它只提供了基本的web服务，其他的功能由开发者自己决定。Flask也是一个轻量级的框架，适合构建小型web应用。相比之下，Django提供了更全面的功能，从ORM到模板引擎，非常适合构建大型复杂的web应用。</p>
<ol start="3">
<li>学习曲线</li>
</ol>
<p>Flask的学习曲线相对较低，因为它非常简单，只需几个文件就可以开始工作了。而Django学习曲线相对更陡峭、复杂，因为它提供了更多的功能和选项。</p>
<ol start="4">
<li>性能</li>
</ol>
<p>Flask通常比Django执行速度更快，因为它非常灵活，只提供了需要的功能，相比之下Django包含了更多的功能和库。但是，这并不意味着Django的执行速度较慢，它仍然是一个高性能的web框架之一。</p>
<p>综上所述，Flask和Django都是优秀的Python web框架。如果你希望构建小型、灵活的web应用并且是Python初学者，那么Flask的学习曲线会更加平缓。但是如果你需要构建大型的、复杂的web应用，并且需要一个完整的解决方案，那么Django可能更适合你。</p>
]]></content>
  </entry>
  <entry>
    <title>title</title>
    <url>/2023/02/26/title/</url>
    <content><![CDATA[]]></content>
      <categories>
        <category>Linux</category>
        <category>tools</category>
        <category>Python</category>
        <category>web</category>
        <category>Database</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>mysql</tag>
        <tag>python</tag>
        <tag>tools</tag>
      </tags>
  </entry>
  <entry>
    <title>监控web的ssl状态并告警</title>
    <url>/2023/02/27/%E7%9B%91%E6%8E%A7web%E7%9A%84ssl%E7%8A%B6%E6%80%81%E5%B9%B6%E5%91%8A%E8%AD%A6/</url>
    <content><![CDATA[<figure class="highlight py"><div class="table-container"><table><tr><td class="code"><pre><span class="line">shell示例:</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义网站域名和端口号信息</span></span><br><span class="line"><span class="comment">#WebName=&quot;hrss-main.wdeduc.com&quot;</span></span><br><span class="line">WebName=<span class="string">&quot;www.baidu.com&quot;</span></span><br><span class="line">Port=<span class="string">&quot;443&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过 Openssl 工具获取到当前证书的到期时间</span></span><br><span class="line">Cert_END_Time=$(echo | openssl s_client -servername $&#123;WebName&#125; -connect $&#123;WebName&#125;:$&#123;Port&#125; <span class="number">2</span>&gt; /dev/null | openssl x509 -noout -dates | grep <span class="string">&#x27;After&#x27;</span> | awk -F <span class="string">&#x27;=&#x27;</span> <span class="string">&#x27;&#123;print $2&#125;&#x27;</span> | awk <span class="string">&#x27;&#123;print $1,$2,$4&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将证书的到期时间转化成时间戳</span></span><br><span class="line">Cert_NED_TimeStamp=$(date +%s -d <span class="string">&quot;$Cert_END_Time&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义当前时间的时间戳</span></span><br><span class="line">Create_TimeStamp=$(date +%s)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过计算获取到证书的剩余天数</span></span><br><span class="line">Rest_Time=$(expr $(expr $Cert_NED_TimeStamp - $Create_TimeStamp) / <span class="number">86400</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置告警提示信息</span></span><br><span class="line">echo <span class="string">&quot;$WebName  网站的 SSL 证书还有 $Rest_Time 天后到期idc&quot;</span> &gt; ssl-monitor.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义钉钉机器人的 API 接口</span></span><br><span class="line">WebHook=<span class="string">&#x27;https://oapi.dingtalk.com/robot/send?access_token=20e3ec13&amp;label=idc&amp;msg_type=markdown&#x27;</span></span><br><span class="line"><span class="comment">#idc关键字存放于echo里面才能触发告警</span></span><br><span class="line"><span class="comment"># 通过 Curl 命令来发送 Post 请求</span></span><br><span class="line">curl <span class="string">&quot;$&#123;WebHook&#125;&quot;</span> -H <span class="string">&#x27;Content-Type: application/json&#x27;</span> -d <span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    &quot;msgtype&quot;: &quot;text&quot;,</span></span><br><span class="line"><span class="string">    &quot;text&quot;: &#123; </span></span><br><span class="line"><span class="string">        &quot;content&quot;: &quot;告警通知&#x27;</span><span class="string">&quot;$(cat ssl-monitor.txt)&quot;</span><span class="string">&#x27;&quot;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span> &amp;&gt; ssl_check.log                    </span><br></pre></td></tr></table></div></figure>

<p>图片示例：<br><img src="https://raw.githubusercontent.com/orangefei/imgbed/master/WechatIMG12845.png"></p>
]]></content>
      <tags>
        <tag>tools</tag>
      </tags>
  </entry>
  <entry>
    <title>统计http状态并实现钉钉告警</title>
    <url>/2023/02/27/%E7%BB%9F%E8%AE%A1http%E7%8A%B6%E6%80%81%E5%B9%B6%E5%AE%9E%E7%8E%B0%E9%92%89%E9%92%89%E5%91%8A%E8%AD%A6/</url>
    <content><![CDATA[<figure class="highlight python"><div class="table-container"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/bin/sh</span></span><br><span class="line">weblist=url.<span class="built_in">list</span>                      </span><br><span class="line"><span class="keyword">for</span> <span class="built_in">list</span> <span class="keyword">in</span> `cat $weblist|grep -E -v <span class="string">&quot;#|^$&quot;</span>`               </span><br><span class="line">do</span><br><span class="line">httpcode=`curl -o /dev/null -s -w %&#123;http_code&#125; <span class="string">&quot;$list&quot;</span>`        </span><br><span class="line">httptime=`curl -o /dev/null -s -w <span class="string">&quot;time_connect: %&#123;time_connect&#125;\ntime_starttransfer: %&#123;time_starttransfer&#125;\ntime_total: %&#123;time_total&#125;\n&quot;</span> <span class="string">&quot;$list&quot;</span>|grep time_total|awk -F <span class="string">&quot;:&quot;</span> <span class="string">&#x27;&#123;print $2*1000&#125;&#x27;</span>`</span><br><span class="line"><span class="keyword">if</span> [ $httpcode = <span class="number">502</span> ]||[ $httpcode = <span class="number">503</span> ]||[ $httpcode = <span class="number">504</span> ]</span><br><span class="line">then</span><br><span class="line">   <span class="comment">#python /app/script/web_monit/sms.py $list &quot;$list 访问有误!状态码为$httpcode!请收到报警后尽快查看并处理!&quot;</span></span><br><span class="line">curl <span class="string">&#x27;https://oapi.dingtalk.com/robot/send?access_token=a36bb5e3ec13&amp;label=idc&amp;level=Warning&amp;msg_type=markdown&#x27;</span>  -H <span class="string">&quot;Content-Type:application/json&quot;</span>  -d <span class="string">&quot;&#123;\&quot;msgtype\&quot;: \&quot;text\&quot;, </span></span><br><span class="line"><span class="string">    \&quot;text\&quot;: &#123;</span></span><br><span class="line"><span class="string">     \&quot;content\&quot;: \&quot;$list 访问有误!状态码为$httpcode!请收到报警后尽快idc查看并处理!\&quot;&#125;, </span></span><br><span class="line"><span class="string">    \&quot;at\&quot;: &#123;</span></span><br><span class="line"><span class="string">        \&quot;atMobiles\&quot;: [</span></span><br><span class="line"><span class="string">            \&quot;130***61\&quot;, </span></span><br><span class="line"><span class="string">        ], </span></span><br><span class="line"><span class="string">        \&quot;isAtAll\&quot;: false</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   echo <span class="string">&quot;$list is checked ok!&quot;</span></span><br><span class="line">fi</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> [ $httptime -ge <span class="number">10000</span> ]</span><br><span class="line">then</span><br><span class="line">   <span class="comment">#python /app/script/web_monit/sms.py $list &quot; $list访问超时!超时时间为$httptime毫秒!请收到报警后尽快查看并处理!&quot;</span></span><br><span class="line">curl <span class="string">&#x27;https://oapi.dingtalk.com/robot/send?access_token=a36bb53ec13&amp;label=idc&amp;level=Warning&amp;msg_type=markdown&#x27;</span>  -H <span class="string">&quot;Content-Type:application/json&quot;</span>  -d <span class="string">&quot;&#123;\&quot;msgtype\&quot;: \&quot;text\&quot;, </span></span><br><span class="line"><span class="string">    \&quot;text\&quot;: &#123;</span></span><br><span class="line"><span class="string">     \&quot;content\&quot;: \&quot;$list 访问超时!超时时间为$httptime毫秒!请收到报警后尽快查看并处理!\&quot;&#125;, </span></span><br><span class="line"><span class="string">    \&quot;at\&quot;: &#123;</span></span><br><span class="line"><span class="string">        \&quot;atMobiles\&quot;: [</span></span><br><span class="line"><span class="string">            \&quot;130***61\&quot;, </span></span><br><span class="line"><span class="string">        ], </span></span><br><span class="line"><span class="string">        \&quot;isAtAll\&quot;: false</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  echo <span class="string">&quot;$list is connect ok!&quot;</span></span><br><span class="line">fi</span><br><span class="line">done</span><br></pre></td></tr></table></div></figure>

<p>图片实例：</p>
<p><img src="https://raw.githubusercontent.com/orangefei/imgbed/master/WechatIMG12868.png"></p>
]]></content>
      <tags>
        <tag>监控</tag>
      </tags>
  </entry>
</search>
